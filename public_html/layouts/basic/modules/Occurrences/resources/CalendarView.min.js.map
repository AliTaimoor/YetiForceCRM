{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nwindow.Occurrences_Calendar_Js = class Occurrences_Calendar_Js extends Vtiger_Calendar_Js {\n\t/**\n\t * Register day click event.\n\t * @param {string} date\n\t */\n\tregisterDayClickEvent(date) {\n\t\tlet self = this;\n\t\tself.getCalendarCreateView().done(function (data) {\n\t\t\tif (data.length <= 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet dateElement = data.find('[name=\"date_start\"]');\n\t\t\tlet dateFormat = dateElement.data('dateFormat').toUpperCase(),\n\t\t\t\ttimeFormat = dateElement.data('hour-format'),\n\t\t\t\tdefaultTimeFormat = 'hh:mm A';\n\t\t\tif (timeFormat == 24) {\n\t\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t\t}\n\t\t\tlet startDateInstance = Date.parse(date);\n\t\t\tlet startDateString = moment(date).format(dateFormat);\n\t\t\tlet startTimeString = moment(date).format(defaultTimeFormat);\n\t\t\tlet endDateInstance = Date.parse(date);\n\t\t\tlet endDateString = moment(date).format(dateFormat);\n\n\t\t\tlet view = self.getCalendarView().fullCalendar('getView');\n\t\t\tlet endTimeString;\n\t\t\tif ('month' == view.name) {\n\t\t\t\tlet diffDays = parseInt((endDateInstance - startDateInstance) / (1000 * 60 * 60 * 24));\n\t\t\t\tif (diffDays > 1) {\n\t\t\t\t\tlet defaultFirstHour = app.getMainParams('startHour');\n\t\t\t\t\tlet explodedTime = defaultFirstHour.split(':');\n\t\t\t\t\tstartTimeString = explodedTime['0'];\n\t\t\t\t\tlet defaultLastHour = app.getMainParams('endHour');\n\t\t\t\t\texplodedTime = defaultLastHour.split(':');\n\t\t\t\t\tendTimeString = explodedTime['0'];\n\t\t\t\t} else {\n\t\t\t\t\tlet now = new Date();\n\t\t\t\t\tstartTimeString = moment(now).format(defaultTimeFormat);\n\t\t\t\t\tendTimeString = moment(now).add(15, 'minutes').format(defaultTimeFormat);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tendTimeString = moment(endDateInstance).add(30, 'minutes').format(defaultTimeFormat);\n\t\t\t}\n\t\t\tdata.find('[name=\"date_start\"]').val(startDateString + ' ' + startTimeString);\n\t\t\tdata.find('[name=\"date_end\"]').val(endDateString + ' ' + endTimeString);\n\n\t\t\tApp.Components.QuickCreate.showModal(data, {\n\t\t\t\tcallbackFunction(data) {\n\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n};\n"],"names":["window","Occurrences_Calendar_Js","date","self","getCalendarCreateView","done","data","length","dateElement","find","dateFormat","toUpperCase","timeFormat","defaultTimeFormat","endTimeString","startDateInstance","Date","parse","startDateString","moment","format","startTimeString","endDateInstance","endDateString","view","getCalendarView","fullCalendar","name","diffDays","parseInt","defaultFirstHour","app","getMainParams","explodedTime","split","defaultLastHour","now","add","val","App","Components","QuickCreate","showModal","callbackFunction","loadCalendarData","Vtiger_Calendar_Js"],"mappings":"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"}