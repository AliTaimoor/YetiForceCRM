{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\n\t'Settings_AutomaticAssignment_Edit_Js',\n\t{},\n\t{\n\t\tcontainer: false,\n\t\tadvanceFilterInstance: false,\n\t\tgetContainer: function () {\n\t\t\tif (this.container == false) {\n\t\t\t\tthis.container = jQuery('div.contentsDiv');\n\t\t\t}\n\t\t\treturn this.container;\n\t\t},\n\t\tregisterBasicEvents: function (container) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tvar advanceFilterContainer = container.find('.filterContainer');\n\t\t\tif (advanceFilterContainer.length) {\n\t\t\t\tthis.advanceFilterInstance = Vtiger_AdvanceFilter_Js.getInstance(advanceFilterContainer);\n\t\t\t}\n\t\t\tvar form = container.find('form');\n\t\t\tif (form.length) {\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\tform.find('[data-inputmask]').inputmask();\n\t\t\t}\n\t\t\tcontainer.find('.select2noactive').each(function (index, domElement) {\n\t\t\t\tvar select = $(domElement);\n\t\t\t\tif (!select.data('select2')) {\n\t\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(select, {\n\t\t\t\t\t\tplaceholder: app.vtranslate('JS_SELECT_AN_OPTION')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar table = app.registerDataTables(container.find('.dataTable'));\n\t\t\tif (table) {\n\t\t\t\ttable.$('.changeRoleType').on('click', function (e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\t\tvar dataElement = element.closest('tr');\n\t\t\t\t\tapp\n\t\t\t\t\t\t.saveAjax('changeRoleType', dataElement.data('value'), {\n\t\t\t\t\t\t\trecord: app.getMainParams('record')\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\ttable.$('.delete').on('click', function (e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\t\tvar dataElement = element.closest('tr');\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\trecord: app.getMainParams('record'),\n\t\t\t\t\t\tvalue: dataElement.data('value'),\n\t\t\t\t\t\tname: dataElement.data('name')\n\t\t\t\t\t};\n\t\t\t\t\tapp.saveAjax('deleteElement', null, params).done(function (data) {\n\t\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tcontainer.find('.fieldContainer').on('click', function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\t\tcontainer.find('.saveValue').on('click', function (e) {\n\t\t\t\tlet button = jQuery(e.currentTarget),\n\t\t\t\t\tfieldContainer = button.closest('.fieldContainer'),\n\t\t\t\t\tbaseFieldName = fieldContainer.data('dbname'),\n\t\t\t\t\tvalue = '';\n\t\t\t\tif (baseFieldName === 'conditions') {\n\t\t\t\t\tlet advfilterlist = thisInstance.advanceFilterInstance.getValues();\n\t\t\t\t\tvalue = JSON.stringify(advfilterlist);\n\t\t\t\t} else {\n\t\t\t\t\tlet fieldName = fieldContainer.data('name'),\n\t\t\t\t\t\tfieldElement = fieldContainer.find('[name=\"' + fieldName + '\"]');\n\t\t\t\t\tif (fieldElement.validationEngine('validate')) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tvalue = fieldElement.val();\n\t\t\t\t}\n\n\t\t\t\tlet params = [];\n\t\t\t\tparams[baseFieldName] = value;\n\t\t\t\tapp.saveAjax('save', jQuery.extend({}, params), { record: app.getMainParams('record') }).done(function () {\n\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t});\n\t\t\t});\n\t\t\tcontainer.find('.js-switch').on('change', (e) => {\n\t\t\t\tconst currentTarget = $(e.currentTarget),\n\t\t\t\t\tstate = currentTarget.val();\n\t\t\t\tlet params = [];\n\t\t\t\tif (currentTarget.hasClass('noField')) {\n\t\t\t\t\tif (state === '1') {\n\t\t\t\t\t\tcurrentTarget.closest('form').find('.fieldToShowHide').removeClass('d-none');\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (state === '0') {\n\t\t\t\t\t\tcurrentTarget.closest('form').find('.fieldToShowHide').addClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparams[currentTarget.attr('name')] = Number(state);\n\t\t\t\tapp\n\t\t\t\t\t.saveAjax('save', jQuery.extend({}, params), { record: app.getMainParams('record') })\n\t\t\t\t\t.done(function (respons) {\n\t\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\trefreshTab: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tSettings_Vtiger_Index_Js.showMessage({ text: app.vtranslate('JS_SAVE_SUCCESS') });\n\t\t\tvar tabContainer = this.getContainer().find('.tab-pane.active');\n\t\t\tif (tabContainer.hasClass('noRefresh')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tAppConnector.request(tabContainer.data('url'))\n\t\t\t\t.done(function (data) {\n\t\t\t\t\ttabContainer.html(data);\n\t\t\t\t\tthisInstance.registerBasicEvents(tabContainer);\n\t\t\t\t})\n\t\t\t\t.fail(function (textStatus, errorThrown) {\n\t\t\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis.registerBasicEvents(this.getContainer());\n\t\t}\n\t}\n);\n"],"names":["jQuery","Class","container","advanceFilterInstance","getContainer","registerBasicEvents","thisInstance","advanceFilterContainer","find","length","Vtiger_AdvanceFilter_Js","getInstance","form","validationEngine","app","validationEngineOptions","inputmask","each","index","domElement","select","$","data","App","Fields","Picklist","showSelect2ElementView","placeholder","vtranslate","table","registerDataTables","on","e","stopPropagation","preventDefault","element","currentTarget","dataElement","closest","saveAjax","record","getMainParams","done","refreshTab","params","value","name","button","fieldContainer","baseFieldName","advfilterlist","getValues","JSON","stringify","fieldName","fieldElement","val","extend","state","hasClass","removeClass","addClass","attr","Number","Settings_Vtiger_Index_Js","showMessage","text","tabContainer","AppConnector","request","html","fail","textStatus","errorThrown","errorLog","registerEvents"],"mappings":"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"}