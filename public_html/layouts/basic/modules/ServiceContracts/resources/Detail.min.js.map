{"version":3,"file":"Detail.min.js","sources":["Detail.js"],"sourcesContent":["/**\n * InRelation SlaPolicy\n *\n * @description InRelation scripts for SlaPolicy module\n * @license     YetiForce Public License 5.0\n * @author      Mariusz Krzaczkowski <m.krzaczkowski@yetiforce.com>\n */\n'use strict';\n\nVtiger_Detail_Js(\n\t'ServiceContracts_Detail_Js',\n\t{},\n\t{\n\t\t/**\n\t\t * Hide all settings\n\t\t *\n\t\t * @return  {self}\n\t\t */\n\t\thideAll() {\n\t\t\tthis.container.find('.js-sla-policy-template, .js-sla-policy-custom').addClass('d-none');\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Show template settings\n\t\t *\n\t\t * @return  {self}\n\t\t */\n\t\tshowTemplateSettings() {\n\t\t\tthis.container.find('.js-sla-policy-template').removeClass('d-none');\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Show custom settings\n\t\t *\n\t\t * @return  {self}\n\t\t */\n\t\tshowCustomSettings() {\n\t\t\tthis.container.find('.js-sla-policy-custom').removeClass('d-none');\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Get template table\n\t\t * @param {Array} rows\n\t\t *\n\t\t * @returns {String} HTML\n\t\t */\n\t\tgetTemplateTableHtml(rows) {\n\t\t\tlet somethingChecked = false;\n\t\t\trows.forEach((row) => {\n\t\t\t\tif (row.checked) {\n\t\t\t\t\tsomethingChecked = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!somethingChecked && typeof rows[0] !== 'undefined') {\n\t\t\t\trows[0].checked = true;\n\t\t\t}\n\t\t\treturn `<div class=\"col-12\"><table class=\"table js-sla-policy-template-table\">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th></th>\n\t\t\t\t<th>${app.vtranslate('JS_POLICY_NAME')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_OPERATIONAL_HOURS')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_REACTION_TIME')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_IDLE_TIME')}</th>\n\t\t\t\t<th>${app.vtranslate('JS_RESOLVE_TIME')}</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t${rows\n\t\t\t.map((row) => {\n\t\t\t\treturn `<tr>\n\t\t\t\t<td><input type=\"radio\" name=\"policy_id\" value=\"${row.id}\"${row.checked ? 'checked=\"checked\"' : ''}></td>\n\t\t\t\t<td>${row.name}</td>\n\t\t\t\t<td>${row.operational_hours}</td>\n\t\t\t\t<td>${row.reaction_time}</td>\n\t\t\t\t<td>${row.idle_time}</td>\n\t\t\t\t<td>${row.resolve_time}</td>\n\t\t\t</tr>`;\n\t\t\t})\n\t\t\t.join('')}\n\t\t</tbody>\n\t\t</table>\n\t\t</div>`;\n\t\t},\n\n\t\t/**\n\t\t * Load predefined sla policy templates\n\t\t */\n\t\tloadTemplates() {\n\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: 'ServiceContracts',\n\t\t\t\taction: 'PolicyTemplatesAjax',\n\t\t\t\ttargetModule: this.targetModule,\n\t\t\t\trecord: Number($('#recordId').val())\n\t\t\t}).done((data) => {\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\tif (data.success) {\n\t\t\t\t\tthis.container.find('.js-sla-policy-template--container').html(this.getTemplateTableHtml(data.result));\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * On policy type change event handler\n\t\t */\n\t\tonPolicyTypeChange() {\n\t\t\tthis.policyType = Number(this.container.find('[name=\"policy_type\"]:checked').val());\n\t\t\tif (this.policyType === 1) {\n\t\t\t\tthis.hideAll().showTemplateSettings().loadTemplates();\n\t\t\t} else if (this.policyType === 2) {\n\t\t\t\tthis.hideAll().showCustomSettings();\n\t\t\t} else {\n\t\t\t\tthis.hideAll();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * On submit event handler\n\t\t *\n\t\t * @param {Event} ev\n\t\t */\n\t\tonSubmit(ev) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t\tthis.container.validationEngine(app.validationEngineOptions);\n\t\t\tconst policyType = Number(this.container.find('[name=\"policy_type\"]:checked').val());\n\t\t\tconst policyId = Number(this.container.find('[name=\"policy_id\"]:checked').val());\n\t\t\tif (policyType === 2 && !this.container.validationEngine('validate')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (policyType === 2 && !this.container.find('.js-custom-row').length) {\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('JS_NO_ITEM_SELECTED'),\n\t\t\t\t\ttype: 'notice',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (policyType === 1 && isNaN(policyId)) {\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('JS_NO_ITEM_SELECTED'),\n\t\t\t\t\ttype: 'notice',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst params = this.container.serializeFormData();\n\t\t\tparams.module = 'ServiceContracts';\n\t\t\tparams.action = 'PolicySaveAjax';\n\t\t\tparams.targetModule = this.targetModule;\n\t\t\tparams.record = $('#recordId').val();\n\t\t\tparams.policyType = policyType;\n\t\t\tparams.policyId = policyId;\n\t\t\tAppConnector.request({ data: params }).done((data) => {\n\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\tif (Array.isArray(data.result)) {\n\t\t\t\t\tdata.result.forEach((row, index) => {\n\t\t\t\t\t\tconst rowElem = this.container.find('.js-custom-row').eq(index);\n\t\t\t\t\t\trowElem.data('id', row.id);\n\t\t\t\t\t\trowElem.find('.js-custom-row-id').val(row.id);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$.each(this.container.find('.js-custom-row'), (index, rowElem) => {\n\t\t\t\t\t\trowElem = $(rowElem);\n\t\t\t\t\t\trowElem.data('id', 0);\n\t\t\t\t\t\trowElem.find('.js-custom-row-id').val(0);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\tanimation: 'show'\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register add record button click\n\t\t */\n\t\tregisterAddRecordBtnClick() {\n\t\t\tlet addPolicyBtn = this.container.find('.js-sla-policy-add-record-btn');\n\t\t\taddPolicyBtn.on('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst index = this.container.find('.js-custom-row').length;\n\t\t\t\tconst row = $(`<div class=\"card js-custom-row shadow-sm mb-2\" data-id=\"0\" data-record-id=\"` + addPolicyBtn.data('record-id') + `\" data-js=\"container\">\n\t\t\t<div class=\"card-body\">\n\t\t\t\t<div class=\"d-flex\">\n\t\t\t\t\t<div class=\"d-block\" style=\"flex-grow:1\">\n\t\t\t\t\t\t<div class=\"row no-gutters\">\n\t\t\t\t\t\t\t<div class=\"col-5 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_BUSINESS_HOURS')}</label>\n\t\t\t\t\t\t\t\t<select class=\"select2\" name=\"business_hours[${index}][]\" multiple data-validation-engine=\"validate[required,funcCall[Vtiger_Base_Validator_Js.invokeValidation]]\">\n\t\t\t\t\t\t\t\t${this.businessHours\n\t\t\t\t\t\t\t\t\t.map((businessHours) => {\n\t\t\t\t\t\t\t\t\t\treturn `<option value=\"${businessHours.id}\">${businessHours.name}</option>`;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.join('')}\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_REACTION_TIME')}</label>\n\t\t\t\t\t\t\t\t<div class=\"input-group time\">\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"reaction_time[${index}]\" class=\"c-time-period\" value=\"1:d\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_IDLE_TIME')}</label>\n\t\t\t\t\t\t\t\t<div class=\"input-group time\">\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"idle_time[${index}]\" class=\"c-time-period\" value=\"1:d\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">\n\t\t\t\t\t\t\t\t<label>${app.vtranslate('JS_RESOLVE_TIME')}</label>\n\t\t\t\t\t\t\t\t<div class=\"input-group time\">\n\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"resolve_time[${index}]\" class=\"c-time-period\" value=\"1:d\">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row mt-2\">\n\t\t\t\t\t\t\t<div class=\"js-conditions-col col\">\n\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"rowid[${index}]\" value=\"0\" class=\"js-custom-row-id\" />\n\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"conditions[${index}]\" class=\"js-conditions-value\" value=\"{}\" data-js=\"container\">\n\t\t\t\t\t\t\t\t${this.container.find('.js-conditions-template').html()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"d-inline-flex text-right border-left\" style=\"flex-grow:0\">\n\t\t\t\t\t\t<div class=\"d-inline-block align-center\" style=\"margin:auto 0;\">\n\t\t\t\t\t\t\t<a href class=\"btn btn-danger ml-4 js-delete-row-action\"><span class=\"fas fa-trash-alt\"></span></a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`\n\t\t\t\t);\n\t\t\t\tApp.Fields.TimePeriod.register(row);\n\t\t\t\tthis.registerDelBtnClick(row);\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(row.find('.select2'));\n\t\t\t\tthis.registerConditionBuilder(\n\t\t\t\t\trow.find('.js-condition-builder').eq(0),\n\t\t\t\t\tthis.container.find('.js-conditions-col').length\n\t\t\t\t);\n\t\t\t\tthis.container.find('.js-custom-conditions').append(row);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Register delete button click\n\t\t *\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterDelBtnClick(container) {\n\t\t\tcontainer.find('.js-delete-row-action').on('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tconst row = $(e.target).closest('.js-custom-row');\n\t\t\t\tconst rowId = Number(row.data('id'));\n\t\t\t\tif (!rowId) {\n\t\t\t\t\trow.remove();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst progress = jQuery.progressIndicator({\n\t\t\t\t\tposition: 'html',\n\t\t\t\t\tblockInfo: {\n\t\t\t\t\t\tenabled: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: 'ServiceContracts',\n\t\t\t\t\taction: 'PolicyDeleteAjax',\n\t\t\t\t\ttargetModule: this.targetModule,\n\t\t\t\t\trecord: row.data('record-id'),\n\t\t\t\t\trowId: rowId\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t$(e.target).closest('.card').remove();\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.vtranslate('JS_SAVE_NOTIFY_OK'),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * On condition change event\n\t\t *\n\t\t * @param   {Vtiger_ConditionBuilder_Js}  instance\n\t\t */\n\t\tonConditionsChange(instance) {\n\t\t\tconst index = this.conditionBuilders.indexOf(instance);\n\t\t\tthis.conditionsBuildersContainers[index]\n\t\t\t\t.parent()\n\t\t\t\t.find('.js-conditions-value')\n\t\t\t\t.val(JSON.stringify(instance.getConditions()));\n\t\t},\n\n\t\t/**\n\t\t * Register condition builder\n\t\t *\n\t\t * @param {jQuery} container\n\t\t * @param {Number} index\n\t\t */\n\t\tregisterConditionBuilder(container, index) {\n\t\t\tthis.conditionBuilders[index] = new Vtiger_ConditionBuilder_Js(\n\t\t\t\tcontainer,\n\t\t\t\tthis.targetModule,\n\t\t\t\tthis.onConditionsChange.bind(this)\n\t\t\t);\n\t\t\tthis.conditionBuilders[index].registerEvents();\n\t\t\tthis.conditionsBuildersContainers[index] = container;\n\t\t},\n\n\t\t/**\n\t\t * Init sla policy events\n\t\t */\n\t\tinitSlaPolicy() {\n\t\t\tthis.container = this.getForm();\n\t\t\tthis.policyType = Number(this.container.find('[name=\"policy_type\"]:checked').val());\n\t\t\tthis.targetModule = this.container.find('[name=\"target\"]').val();\n\t\t\tthis.businessHours = JSON.parse(this.container.find('.js-all-business-hours').val());\n\t\t\tthis.conditionBuilders = [];\n\t\t\tthis.conditionsBuildersContainers = [];\n\t\t\tthis.container.off('submit').on('submit', this.onSubmit.bind(this));\n\t\t\tthis.container.find('.js-sla-policy-type-radio').on('click', (e) => this.onPolicyTypeChange());\n\t\t\tthis.onPolicyTypeChange();\n\t\t\tApp.Fields.TimePeriod.register(this.container);\n\t\t\tthis.registerAddRecordBtnClick();\n\t\t\tthis.registerDelBtnClick(this.container);\n\t\t\t$.each(this.container.find('.js-custom-conditions .js-condition-builder'), (index, col) => {\n\t\t\t\tthis.registerConditionBuilder($(col), index);\n\t\t\t});\n\t\t},\n\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tlet detailViewForm = this.getForm();\n\t\t\tif (detailViewForm.find('.js-sla-policy').length) {\n\t\t\t\tthis.initSlaPolicy();\n\t\t\t}\n\t\t\tapp.event.on('DetailView.Tab.AfterLoad', (event, data, instance) => {\n\t\t\t\tif (instance.getForm().find('.js-sla-policy').length) {\n\t\t\t\t\tinstance.initSlaPolicy();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Detail_Js","hideAll","container","find","addClass","showTemplateSettings","removeClass","showCustomSettings","getTemplateTableHtml","rows","somethingChecked","forEach","row","checked","app","vtranslate","map","id","name","operational_hours","reaction_time","idle_time","resolve_time","join","loadTemplates","progress","jQuery","progressIndicator","position","blockInfo","enabled","AppConnector","request","module","action","targetModule","record","Number","$","val","done","data","mode","success","html","result","onPolicyTypeChange","policyType","onSubmit","ev","preventDefault","stopPropagation","validationEngine","validationEngineOptions","policyId","length","showNotify","text","type","animation","isNaN","params","serializeFormData","Array","isArray","index","rowElem","eq","each","registerAddRecordBtnClick","addPolicyBtn","on","e","businessHours","App","Fields","TimePeriod","register","registerDelBtnClick","Picklist","showSelect2ElementView","registerConditionBuilder","append","target","closest","rowId","remove","onConditionsChange","instance","conditionBuilders","indexOf","conditionsBuildersContainers","parent","JSON","stringify","getConditions","Vtiger_ConditionBuilder_Js","bind","registerEvents","initSlaPolicy","getForm","parse","off","col","_super","detailViewForm","event"],"mappings":"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"}