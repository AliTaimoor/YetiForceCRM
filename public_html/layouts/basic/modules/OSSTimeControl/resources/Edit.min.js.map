{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\n\t'OSSTimeControl_Edit_Js',\n\t{},\n\t{\n\t\tregisterGenerateTCFieldTimeAndCost: function () {\n\t\t\tvar thisInstance = this;\n\t\t\t$('input[name=\"sum_time\"]').attr('readonly', 'readonly').css('width', '80px');\n\t\t\tvar form = thisInstance.getForm();\n\t\t\tvar sumeTime = thisInstance.differenceDays(form);\n\t\t\tvar hours = (Math.ceil((sumeTime / 3600000) * 100) / 100).toFixed(2);\n\n\t\t\tjQuery('input[name=\"sum_time\"]').val(hours);\n\t\t\tjQuery('.dateField').on('change', function () {\n\t\t\t\tsumeTime = thisInstance.differenceDays(form);\n\t\t\t\tif (sumeTime == 'Error') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\thours = (Math.ceil((sumeTime / 3600000) * 100) / 100).toFixed(2);\n\t\t\t\tjQuery('input[name=\"sum_time\"]').val(hours);\n\t\t\t});\n\t\t\tjQuery('.clockPicker').on('change', function () {\n\t\t\t\tsumeTime = thisInstance.differenceDays(form);\n\t\t\t\tif (sumeTime == 'Error') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\thours = (Math.round((sumeTime / 3600000) * 100) / 100).toFixed(2);\n\t\t\t\tjQuery('input[name=\"sum_time\"]').val(hours);\n\t\t\t});\n\t\t},\n\n\t\tdifferenceDays: function (container) {\n\t\t\tlet firstDate = container.find('input[name=\"date_start\"]');\n\t\t\tlet firstDateFormat = firstDate.data('date-format');\n\t\t\tlet firstDateValue = firstDate.val();\n\t\t\tlet secondDate = container.find('input[name=\"due_date\"]');\n\t\t\tlet secondDateFormat = secondDate.data('date-format');\n\t\t\tlet secondDateValue = secondDate.val();\n\t\t\tlet firstTime = container.find('input[name=\"time_start\"]');\n\t\t\tlet secondTime = container.find('input[name=\"time_end\"]');\n\t\t\tif (firstTime.length) {\n\t\t\t\tfirstDateValue = firstDateValue + ' ' + firstTime.val();\n\t\t\t}\n\t\t\tif (secondTime.length) {\n\t\t\t\tsecondDateValue = secondDateValue + ' ' + secondTime.val();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tlet firstDateInstance = Vtiger_Helper_Js.getDateInstance(firstDateValue, firstDateFormat);\n\t\t\t\tlet secondDateInstance = Vtiger_Helper_Js.getDateInstance(secondDateValue, secondDateFormat);\n\t\t\t\tlet timeBetweenDates = secondDateInstance - firstDateInstance;\n\t\t\t\tif (timeBetweenDates >= 0) {\n\t\t\t\t\treturn timeBetweenDates;\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\treturn 'Error';\n\t\t\t}\n\t\t\treturn 'Error';\n\t\t},\n\n\t\t/**\n\t\t * Function to register recordpresave event\n\t\t */\n\t\tregisterRecordPreSaveEvent: function (container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar form = $('form.js-form');\n\t\t\tif (form.length == 0) {\n\t\t\t\tform = this.getForm();\n\t\t\t}\n\t\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\t\tvar sumeTime2 = thisInstance.differenceDays(form);\n\t\t\t\tif (sumeTime2 == 'Error') {\n\t\t\t\t\tvar parametres = {\n\t\t\t\t\t\ttext: app.vtranslate('JS_DATE_SHOULD_BE_GREATER_THAN'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tapp.showNotify(parametres);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tescapeRegExp: function (string) {\n\t\t\treturn string.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n\t\t},\n\t\treplaceAll: function (string, find, replace) {\n\t\t\tvar thisInstance = this;\n\t\t\tstring = string.replace(new RegExp(thisInstance.escapeRegExp('&Oacute;'), 'g'), 'Ã“');\n\t\t\treturn string.replace(new RegExp(thisInstance.escapeRegExp(find), 'g'), replace);\n\t\t},\n\t\tregisterBasicEvents: function (container) {\n\t\t\tthis._super(container);\n\t\t\tthis.registerRecordPreSaveEvent(container);\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tthis._super();\n\t\t\tthis.registerGenerateTCFieldTimeAndCost();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_Edit_Js","registerGenerateTCFieldTimeAndCost","thisInstance","$","attr","css","form","getForm","sumeTime","differenceDays","hours","Math","ceil","toFixed","jQuery","val","on","round","container","firstDate","find","firstDateFormat","data","firstDateValue","secondDate","secondDateFormat","secondDateValue","firstTime","secondTime","length","firstDateInstance","Vtiger_Helper_Js","getDateInstance","secondDateInstance","timeBetweenDates","err","registerRecordPreSaveEvent","recordPreSave","sumeTime2","parametres","text","app","vtranslate","type","showNotify","escapeRegExp","string","replace","replaceAll","RegExp","registerBasicEvents","_super","registerEvents"],"mappings":"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"}