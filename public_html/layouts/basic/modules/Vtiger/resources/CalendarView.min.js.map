{"version":3,"file":"CalendarView.min.js","sources":["CalendarView.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n/**\n * Class representing a standard calendar.\n * @extends Calendar_Js\n */\nwindow.Vtiger_Calendar_Js = class Vtiger_Calendar_Js extends Calendar_Js {\n\tconstructor(container, readonly) {\n\t\tsuper(container, readonly, false);\n\t\tthis.browserHistory = false;\n\t}\n\t/**\n\t * Set calendar module options.\n\t * @returns {{allDaySlot: boolean, dayClick: object, selectable: boolean}}\n\t */\n\tsetCalendarModuleOptions() {\n\t\tconst self = this;\n\t\treturn {\n\t\t\tallDaySlot: false,\n\t\t\tdateClick: (args) => {\n\t\t\t\tif (this.eventCreate) {\n\t\t\t\t\tself.registerDayClickEvent(args);\n\t\t\t\t}\n\t\t\t},\n\t\t\tselectable: false,\n\t\t\teventClick: function (info) {\n\t\t\t\tinfo.jsEvent.preventDefault();\n\t\t\t\tconst element = $(info.el);\n\t\t\t\tlet link = element.attr('href');\n\t\t\t\tif (!link) {\n\t\t\t\t\tlink = element.find('a').attr('href');\n\t\t\t\t}\n\t\t\t\tif (link && $.inArray('js-show-modal', info.event.classNames) !== -1) {\n\t\t\t\t\tapp.showModalWindow(null, link.replace('view=', 'xview=') + '&view=QuickDetailModal');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\t/**\n\t * Set calendar module's options.\n\t * @returns {object}\n\t */\n\tsetCalendarAdvancedOptions() {\n\t\tconst self = this;\n\t\treturn Object.assign(super.setCalendarAdvancedOptions(), {\n\t\t\theaderToolbar: {\n\t\t\t\tleft: `dayGridMonth,${app.getMainParams('weekView')},${app.getMainParams('dayView')},listWeek,today`,\n\t\t\t\tcenter: 'prevYear,prev,title,next,nextYear',\n\t\t\t\tright: ''\n\t\t\t},\n\t\t\tselect: function (info) {\n\t\t\t\tself.selectDays(info);\n\t\t\t},\n\t\t\tdatesSet: function (dateInfo) {\n\t\t\t\tapp.event.trigger('Calendar.DatesSet', dateInfo, this);\n\t\t\t\tif (self.fullCalendar.view !== 'year') {\n\t\t\t\t\tself.loadCalendarData();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\t/**\n\t * Function invokes by fullCalendar, sets selected days in form\n\t * @param {object} info\n\t */\n\tselectDays(info) {\n\t\tif (!this.container.find('.js-right-panel-event-link').length) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.container.find('.js-right-panel-event-link').tab('show');\n\t\tsuper.selectDays(info);\n\t}\n\t/**\n\t * Load calendar data\n\t */\n\tloadCalendarData() {\n\t\tconst self = this,\n\t\t\tdefaultParams = this.getDefaultParams(),\n\t\t\tprogressInstance = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\tself.fullCalendar.removeAllEvents();\n\t\tself.clearFilterButton(defaultParams['user'], self.getCurrentCvId());\n\t\tAppConnector.request(defaultParams).done((events) => {\n\t\t\tself.fullCalendar.removeAllEvents();\n\t\t\tself.fullCalendar.addEventSource(events.result);\n\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t});\n\t}\n\t/**\n\t * Reload calendar data after changing search parameters\n\t */\n\treloadCalendarData() {\n\t\tsuper.reloadCalendarData();\n\t\tthis.updateCountTaskCalendar();\n\t}\n\t/**\n\t * Show/hide clear filter button\n\t */\n\tclearFilterButton(user, cvId) {\n\t\tlet currentUser = parseInt(app.getMainParams('userId')),\n\t\t\ttime = app.getMainParams('showType'),\n\t\t\tstatement =\n\t\t\t\tJSON.stringify(user['selectedIds']) === JSON.stringify([`${currentUser}`]) &&\n\t\t\t\tcvId === undefined &&\n\t\t\t\ttime === 'current';\n\t\t$('.js-calendar__clear-filters').toggleClass('d-none', statement);\n\t}\n\t/**\n\t * Default params\n\t * @returns {{module: *, action: string, mode: string, start: *, end: *, user: *, emptyFilters: boolean}}\n\t */\n\tgetDefaultParams() {\n\t\tlet options = super.getDefaultParams(),\n\t\t\tuser = this.getSelectedUsersCalendar();\n\t\tif (0 === user.length) {\n\t\t\tuser = app.getMainParams('usersId');\n\t\t}\n\t\tif (user === undefined) {\n\t\t\tuser = [app.getMainParams('userId')];\n\t\t}\n\t\tif (this.fullCalendar.view === 'timeGridDay') {\n\t\t\tthis.fullCalendar.view.activeEnd = this.fullCalendar.view.activeEnd.add(1, 'day');\n\t\t}\n\t\tconst time = this.getSidebarView().find('.js-switch--showType input:checked').data('val');\n\t\toptions.time !== undefined ? time : app.getMainParams('showType');\n\t\toptions.history = true;\n\t\toptions.user = user;\n\t\treturn options;\n\t}\n\t/**\n\t * Get selected users\n\t * @returns {{ selectedIds: array, excludedIds: array }}\n\t */\n\tgetSelectedUsersCalendar() {\n\t\tconst sidebar = this.getSidebarView();\n\t\tlet selectedUsers = sidebar.find('.js-input-user-owner-id:checked'),\n\t\t\tnotSelectedUsers = sidebar.find('.js-input-user-owner-id:not(:checked)'),\n\t\t\tselectedUsersAjax = sidebar.find('.js-input-user-owner-id-ajax'),\n\t\t\tselectedRolesAjax = sidebar.find('.js-input-role-owner-id-ajax'),\n\t\t\tcheckboxSelectAll = sidebar.find('.js-select-all'),\n\t\t\tselectedIds = [],\n\t\t\texcludedIds = [];\n\n\t\tlet ifSelectAllIsChecked = checkboxSelectAll.length > 0 && checkboxSelectAll.is(':checked');\n\t\tif (ifSelectAllIsChecked) {\n\t\t\tselectedIds.push('all');\n\t\t} else if (selectedUsers.length > 0) {\n\t\t\tselectedUsers.each(function () {\n\t\t\t\tselectedIds.push($(this).val());\n\t\t\t});\n\t\t}\n\t\tif (selectedUsersAjax.length > 0) {\n\t\t\tselectedIds = selectedUsersAjax.val().concat(selectedRolesAjax.val());\n\t\t}\n\t\tif (ifSelectAllIsChecked && notSelectedUsers) {\n\t\t\tnotSelectedUsers.each(function () {\n\t\t\t\texcludedIds.push($(this).val());\n\t\t\t});\n\t\t}\n\t\tif (0 === selectedIds.length && CONFIG.userId) {\n\t\t\tselectedIds.push(CONFIG.userId);\n\t\t}\n\t\treturn { selectedIds: selectedIds, excludedIds: excludedIds };\n\t}\n\t/**\n\t * Register day click event.\n\t * @param {object} info\n\t */\n\tregisterDayClickEvent(info) {\n\t\tconst self = this,\n\t\t\tuserFormat = App.Fields.Date.dateToUserFormat(info.date);\n\t\tif (!CONFIG.isQuickCreateSupported) {\n\t\t\tapp.openUrl(\n\t\t\t\t'index.php?module=' +\n\t\t\t\t\t(this.module ? this.module : CONFIG.module) +\n\t\t\t\t\t'&view=Edit&date_start=' +\n\t\t\t\t\tuserFormat +\n\t\t\t\t\t'&due_date=' +\n\t\t\t\t\tuserFormat\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tself.getCalendarCreateView().done((data) => {\n\t\t\tApp.Components.QuickCreate.showModal(data, {\n\t\t\t\tcallbackFunction: () => {\n\t\t\t\t\tself.reloadCalendarData();\n\t\t\t\t},\n\t\t\t\tcallbackPostShown: (modal) => {\n\t\t\t\t\tself.dayCallbackCreateModal(modal, info);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\t/**\n\t * Callback after shown create modal\n\t * @param {jQuery} modal\n\t * @param {object} info\n\t */\n\tdayCallbackCreateModal(modal, info) {\n\t\tlet dateFormat = modal.find('[name=\"date_start\"]').data('dateFormat'),\n\t\t\ttimeFormat = modal.find('[name=\"time_start\"]').data('format'),\n\t\t\tdefaultTimeFormat = 'hh:mm A',\n\t\t\tuserFormat = App.Fields.Date.dateToUserFormat(info.date, dateFormat),\n\t\t\tendTimeString;\n\n\t\tif (timeFormat == 24) {\n\t\t\tdefaultTimeFormat = 'HH:mm';\n\t\t}\n\t\tlet startTimeString = moment(info.date).format(defaultTimeFormat);\n\t\tif ('dayGridMonth' == this.fullCalendar.view.type) {\n\t\t\tlet now = new Date();\n\t\t\tstartTimeString = moment(now).format(defaultTimeFormat);\n\t\t\tendTimeString = moment(now).add(15, 'minutes').format(defaultTimeFormat);\n\t\t} else {\n\t\t\tendTimeString = moment(info.date).add(30, 'minutes').format(defaultTimeFormat);\n\t\t}\n\t\tmodal.find('[name=\"date_start\"]').val(userFormat);\n\t\tmodal.find('[name=\"due_date\"]').val(userFormat);\n\t\tmodal.find('[name=\"time_start\"]').val(startTimeString);\n\t\tmodal.find('[name=\"time_end\"]').val(endTimeString);\n\t}\n\t/**\n\t * Register switch events\n\t */\n\tregisterSwitchEvents() {\n\t\tlet isWorkDays,\n\t\t\tswitchShowTypeVal,\n\t\t\tswitchContainer = $('.js-calendar__tab--filters'),\n\t\t\tswitchShowType = switchContainer.find('.js-switch--showType'),\n\t\t\tshowTypeState = switchShowType.find('.js-switch--label-on.active').length ? 'current' : 'history',\n\t\t\tswitchSwitchingDays = switchContainer.find('.js-switch--switchingDays'),\n\t\t\tswitchingDaysState = switchSwitchingDays.find('.js-switch--label-on.active').length ? 'workDays' : 'all';\n\t\tlet historyParams = app.getMainParams('historyParams', true);\n\t\tif (historyParams === '') {\n\t\t\tisWorkDays =\n\t\t\t\tapp.getMainParams('switchingDays') === 'workDays' && app.moduleCacheGet('defaultSwitchingDays') !== 'all';\n\t\t\tswitchShowTypeVal =\n\t\t\t\tapp.getMainParams('showType') === 'current' && app.moduleCacheGet('defaultShowType') !== 'history';\n\t\t\tif (!switchShowTypeVal) {\n\t\t\t\tswitchShowType.find('.js-switch--label-off').button('toggle');\n\t\t\t}\n\t\t} else {\n\t\t\tif (historyParams.time !== undefined) {\n\t\t\t\tapp.setMainParams('showType', historyParams.time);\n\t\t\t}\n\t\t\tapp.setMainParams('switchingDays', historyParams.hiddenDays === '' ? 'all' : 'workDays');\n\t\t}\n\t\tswitchShowType.on('change', 'input', (e) => {\n\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\tapp.setMainParams('showType', 'current');\n\t\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\tapp.setMainParams('showType', 'history');\n\t\t\t\tapp.moduleCacheSet('defaultShowType', 'history');\n\t\t\t}\n\t\t\tthis.reloadCalendarData();\n\t\t});\n\t\tif (app.getMainParams('showType') !== showTypeState) {\n\t\t\t$('label.active', switchShowType).find('input').filter(':first').trigger('change');\n\t\t}\n\t\tif (switchSwitchingDays.length) {\n\t\t\tif (typeof isWorkDays !== 'undefined' && !isWorkDays) {\n\t\t\t\tswitchSwitchingDays.find('.js-switch--label-off').button('toggle');\n\t\t\t}\n\t\t\tswitchSwitchingDays.on('change', 'input', (e) => {\n\t\t\t\tconst currentTarget = $(e.currentTarget);\n\t\t\t\tlet hiddenDays = [];\n\t\t\t\tif (typeof currentTarget.data('on-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('switchingDays', 'workDays');\n\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'workDays');\n\t\t\t\t\thiddenDays = app.getMainParams('hiddenDays', true);\n\t\t\t\t} else if (typeof currentTarget.data('off-text') !== 'undefined') {\n\t\t\t\t\tapp.setMainParams('switchingDays', 'all');\n\t\t\t\t\tapp.moduleCacheSet('defaultSwitchingDays', 'all');\n\t\t\t\t}\n\t\t\t\tthis.fullCalendar.setOption('hiddenDays', hiddenDays);\n\t\t\t\tthis.fullCalendar.setOption('height', this.setCalendarHeight());\n\t\t\t\tif (this.fullCalendar.view.type === 'year') {\n\t\t\t\t\tconsole.log('this.registerViewRenderEvents(this.calendarView.fullCalendar');\n\t\t\t\t\t// this.registerViewRenderEvents(this.calendarView.fullCalendar('getView'));  //todo\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (app.getMainParams('switchingDays') !== switchingDaysState) {\n\t\t\t\t$('label.active', switchSwitchingDays).find('input').filter(':first').trigger('change');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Function toggles next year/month and general arrows on view render\n\t */\n\tregisterViewRenderEvents() {\n\t\tlet toolbar = this.calendarView.find('.fc-toolbar.fc-header-toolbar');\n\t\tthis.showChangeDateButtons(toolbar);\n\t\tthis.appendSubDateRow(toolbar);\n\t\tthis.refreshDatesRowView();\n\t\tthis.addHeaderButtons();\n\t\tthis.showTodayButtonCheckbox(toolbar);\n\t\tapp.event.on('Calendar.DatesSet', () => {\n\t\t\tthis.showChangeDateButtons(toolbar);\n\t\t\tthis.refreshDatesRowView();\n\t\t\tthis.showTodayButtonCheckbox(toolbar);\n\t\t});\n\t}\n\t/**\n\t * Function shows change date buttons in calendar's header for specific view\n\t * @param {jQuery} toolbar\n\t */\n\tshowChangeDateButtons(toolbar) {\n\t\tconst view = this.fullCalendar.view;\n\t\tconst buttonText = this.calendarOptions.buttonText;\n\t\tlet nextPrevButtons = toolbar.find('.fc-prev-button, .fc-next-button'),\n\t\t\tyearButtons = toolbar.find('.fc-prevYear-button, .fc-nextYear-button');\n\t\tyearButtons.first().html(`<span class=\"fas fa-xs fa-minus mr-1\"></span>${buttonText['year']}`);\n\t\tyearButtons.last().html(`${buttonText['year']}<span class=\"fas fa-xs fa-plus ml-1\"></span>`);\n\t\tif (view.type !== 'year' && Calendar_Js.viewsNamesLabels[view.type]) {\n\t\t\tlet viewType = Calendar_Js.viewsNamesLabels[view.type];\n\t\t\tnextPrevButtons.first().html(`<span class=\"fas fa-xs fa-minus mr-1\"></span>${buttonText[viewType]}`);\n\t\t\tnextPrevButtons.last().html(`${buttonText[viewType]}<span class=\"fas fa-xs fa-plus ml-1\"></span>`);\n\t\t}\n\t\tif (view.type === 'year') {\n\t\t\tnextPrevButtons.hide();\n\t\t\tyearButtons.show();\n\t\t} else if (view.type === 'dayGridMonth') {\n\t\t\tnextPrevButtons.show();\n\t\t\tyearButtons.show();\n\t\t} else if (view.type === 'list') {\n\t\t\tnextPrevButtons.hide();\n\t\t\tyearButtons.hide();\n\t\t} else {\n\t\t\tnextPrevButtons.show();\n\t\t\tyearButtons.hide();\n\t\t}\n\t}\n\t/**\n\t * Appends sub date row to calendar header and register its scroll\n\t * @param {jQuery} toolbar\n\t */\n\tappendSubDateRow(toolbar) {\n\t\tif (!this.calendarView.find('.js-dates-row').length) {\n\t\t\tthis.subDateRow =\n\t\t\t\t$(`<div class=\"js-scroll js-dates-row u-overflow-auto-lg-down order-4 flex-grow-1 position-relative my-1 w-100\" data-js=\"perfectScrollbar | container\">\n\t\t\t\t\t\t<div class=\"d-flex flex-nowrap w-100\">\n\t\t\t\t\t\t\t<div class=\"js-sub-date-list w-100 sub-date-list row no-gutters flex-nowrap nav nav-tabs\" data-js=\"data-type\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`);\n\t\t\ttoolbar.append(this.subDateRow);\n\t\t\tif ($(window).width() > app.breakpoints.lg) {\n\t\t\t\tapp.showNewScrollbar(toolbar);\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Refresh date bar with counts\n\t */\n\trefreshDatesRowView() {\n\t\tconst self = this;\n\t\tswitch (this.fullCalendar.view.type) {\n\t\t\tcase 'year':\n\t\t\t\tself.generateYearList();\n\t\t\t\tbreak;\n\t\t\tcase 'dayGridMonth':\n\t\t\t\tself.generateMonthList();\n\t\t\t\tbreak;\n\t\t\tcase 'dayGridWeek':\n\t\t\tcase 'timeGridWeek':\n\t\t\tcase 'listWeek':\n\t\t\t\tself.generateWeekList();\n\t\t\t\tbreak;\n\t\t\tcase 'dayGridWeek':\n\t\t\tcase 'timeGridDay':\n\t\t\t\tself.generateDaysList();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.container.find('.js-dates-row .js-sub-date-list').html('');\n\t\t\t\tbreak;\n\t\t}\n\t\tself.updateCountTaskCalendar();\n\t\tself.registerDatesChange();\n\t}\n\t/**\n\t * Generate days bar list\n\t */\n\tgenerateDaysList() {\n\t\tconst datesView = this.container.find('.js-dates-row'),\n\t\t\tactiveDays = moment(this.fullCalendar.view.currentStart).format('DDD'),\n\t\t\tnextDays = moment(this.fullCalendar.view.currentStart).add(7, 'days');\n\t\tlet prevDays = moment(this.fullCalendar.view.currentStart).subtract(5, 'days'),\n\t\t\tdaysToShow = nextDays.diff(prevDays, 'days'),\n\t\t\thtml = '';\n\n\t\tfor (let day = 0; day < daysToShow; ++day) {\n\t\t\tif (app.getMainParams('switchingDays') === 'workDays' && app.moduleCacheGet('defaultSwitchingDays') !== 'all') {\n\t\t\t\tif ($.inArray(prevDays.day(), app.getMainParams('hiddenDays', true)) !== -1) {\n\t\t\t\t\tprevDays = moment(prevDays).add(1, 'days');\n\t\t\t\t\tdaysToShow++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet date = prevDays.format('YYYY-MM-DD'),\n\t\t\t\tdateUser = App.Fields.Date.dateToUserFormat(date),\n\t\t\t\tactive = '';\n\t\t\tif (prevDays.format('DDD') === activeDays) {\n\t\t\t\tactive = 'active';\n\t\t\t}\n\t\t\thtml += `<div data-date=\"${date}\" data-dates=\"${date}|${date}\" data-type=\"days\"\n\t\t\t\tclass=\"js-sub-record sub-record nav-item col-1 px-0\"  data-js=\"click | class: active\">\n\t\t\t\t<div class=\"sub-record-content nav-link js-popover-tooltip ${active}\"\n\t\t\t\t\ttitle=\"${App.Fields.Date.fullDaysTranslated[prevDays.format('d')]} ${dateUser}\">\n\t\t\t\t<div class=\"sub-date-name\">${app.vtranslate('JS_DAY_SHORT')} ${prevDays.format('DD')}\n\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t</div></div></div>`;\n\t\t\tprevDays = moment(prevDays).add(1, 'days');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\t/**\n\t * Generate weeks bar list\n\t */\n\tgenerateWeekList() {\n\t\tconst datesView = this.container.find('.js-dates-row'),\n\t\t\tactiveWeek = moment(this.fullCalendar.view.currentStart).format('WW'),\n\t\t\tnextWeeks = moment(this.fullCalendar.view.currentStart).add(6, 'weeks');\n\t\tlet prevWeeks = moment(this.fullCalendar.view.currentStart).subtract(5, 'weeks'),\n\t\t\thtml = '';\n\n\t\twhile (prevWeeks <= nextWeeks) {\n\t\t\tlet date = prevWeeks.format('YYYY-MM-DD'),\n\t\t\t\tdateEnd = moment(prevWeeks).add(6, 'day').format('YYYY-MM-DD'),\n\t\t\t\tdateUser = App.Fields.Date.dateToUserFormat(date),\n\t\t\t\tdateEndUser = App.Fields.Date.dateToUserFormat(dateEnd),\n\t\t\t\tactive = '';\n\t\t\tif (prevWeeks.format('WW') === activeWeek) {\n\t\t\t\tactive = 'active';\n\t\t\t}\n\t\t\thtml += `<div data-date=\"${date}\" data-dates=\"${date}|${dateEnd}\"\n\t\t\t\tclass=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"weeks\" data-js=\"click | class: active\">\n\t\t\t\t<div class=\"sub-record-content nav-link js-popover-tooltip ${active}\" title=\"${dateUser} > ${dateEndUser}\">\n\t\t\t\t<div class=\"sub-date-name\">${app.vtranslate('JS_WEEK_SHORT')} ${prevWeeks.format('WW')}\n\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t</div></div></div>`;\n\t\t\tprevWeeks.add(1, 'weeks');\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\t/**\n\t * Generate month bar list\n\t */\n\tgenerateMonthList() {\n\t\tconst self = this;\n\t\tconst datesView = this.container.find('.js-dates-row'),\n\t\t\tactiveMonth = this.fullCalendar.view.currentStart.getMonth(),\n\t\t\tactiveYear = this.fullCalendar.view.currentStart.getFullYear();\n\t\tlet html = '';\n\t\tfor (let month = 0; 12 > month; ++month) {\n\t\t\tlet m = month <= 8 ? '0' + (month + 1) : month + 1,\n\t\t\t\tlastDay = App.Fields.Date.getLastMonthDay(activeYear, m),\n\t\t\t\tdate = activeYear + '-' + m + '-01',\n\t\t\t\tdateEnd = activeYear + '-' + m + '-' + lastDay,\n\t\t\t\tdateUser = App.Fields.Date.dateToUserFormat(date),\n\t\t\t\tdateEndUser = App.Fields.Date.dateToUserFormat(dateEnd),\n\t\t\t\tactive = '';\n\t\t\tif (month === activeMonth) {\n\t\t\t\tactive = 'active';\n\t\t\t}\n\t\t\thtml += `<div data-date=\"${date}\" data-dates=\"${date}|${dateEnd}\"\n\t\t\t\tclass=\"js-sub-record sub-record nav-item col-1 px-0\" data-type=\"months\" data-js=\"click | class: active\">\n\t\t\t\t<div class=\"sub-record-content nav-link js-popover-tooltip ${active}\" title=\"${dateUser} > ${dateEndUser}\">\n\t\t\t\t<div class=\"sub-date-name\">${App.Fields.Date.monthsTranslated[month]}\n\t\t\t\t<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div>\n\t\t\t\t</div></div></div>`;\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\t/**\n\t * Generate year bar list\n\t */\n\tgenerateYearList() {\n\t\tconst datesView = this.container.find('.js-dates-row'),\n\t\t\tactiveYear = this.fullCalendar.view.currentStart.getFullYear(),\n\t\t\tnextYear = activeYear + 1;\n\t\tlet prevYear = activeYear - 1,\n\t\t\thtml = '';\n\t\twhile (prevYear <= nextYear) {\n\t\t\tlet date = prevYear + '-01-01',\n\t\t\t\tdateEnd = prevYear + '-12-31',\n\t\t\t\tactive = '';\n\t\t\tif (prevYear === activeYear) {\n\t\t\t\tactive = 'active';\n\t\t\t}\n\t\t\thtml += `<div data-date=\"${date}\" data-dates=\"${date}|${dateEnd}\"\n\t\t\t\tclass=\"js-sub-record sub-record col-4 nav-item\" data-type=\"years\" data-js=\"click | class: active\">\n\t\t\t\t<div class=\"sub-record-content nav-link ${active}\">\n\t\t\t\t<div class=\"sub-date-name\">${prevYear}<div class=\"js-count-events count badge c-badge--md ml-1\" data-js=\"html\">0</div></div>\n\t\t\t\t</div></div>`;\n\t\t\tprevYear = prevYear + 1;\n\t\t}\n\t\tdatesView.find('.js-sub-date-list').html(html);\n\t}\n\t/**\n\t * Counting the number of events in the bar for the current view\n\t */\n\tupdateCountTaskCalendar() {\n\t\tconst datesView = this.container.find('.js-dates-row'),\n\t\t\tsubDatesElements = datesView.find('.js-sub-record');\n\t\tlet options = this.getDefaultParams(),\n\t\t\tdateArray = {};\n\t\tdelete options.start;\n\t\tdelete options.end;\n\t\tsubDatesElements.each(function (key) {\n\t\t\tdateArray[key] = $(this).data('dates').split('|');\n\t\t});\n\t\toptions.mode = 'getCountEventsGroup';\n\t\toptions.dates = dateArray;\n\t\tAppConnector.request(options).done(function (events) {\n\t\t\tsubDatesElements.each(function (key) {\n\t\t\t\t$(this).find('.js-count-events').removeClass('hide').html(events.result[key]);\n\t\t\t});\n\t\t});\n\t}\n\t/**\n\t * Registration of the date change in the counting the number of events bar\n\t */\n\tregisterDatesChange() {\n\t\tthis.container.find('.js-dates-row .js-sub-record').on('click', (e) => {\n\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\tcurrentTarget.addClass('active');\n\t\t\tthis.fullCalendar.gotoDate(currentTarget.data('date'));\n\t\t});\n\t}\n\t/**\n\t * Add header buttons\n\t */\n\taddHeaderButtons() {\n\t\tif (this.calendarView.find('.js-calendar__view-btn').length) {\n\t\t\treturn;\n\t\t}\n\t\tlet buttonsContainer = this.calendarView.prev('.js-calendar__header-buttons'),\n\t\t\tviewBtn = buttonsContainer.find('.js-calendar__view-btn').clone(),\n\t\t\tfilters = buttonsContainer.find('.js-calendar__filter-container').clone(),\n\t\t\ttoolbar = this.calendarView.find('.fc-toolbar-chunk');\n\t\ttoolbar.first().addClass('fc-left');\n\t\ttoolbar.eq(1).addClass('fc-center');\n\t\tthis.calendarView.find('.fc-left .fc-button-group').prepend(viewBtn);\n\t\tthis.calendarView.find('.fc-center').after(filters);\n\t\tthis.registerClearFilterButton();\n\t\tthis.registerFilterTabChange();\n\t}\n\t/**\n\t * Register clear filter button\n\t */\n\tregisterClearFilterButton() {\n\t\tconst sidebar = this.getSidebarView(),\n\t\t\tclearBtn = this.calendarView.find('.js-calendar__clear-filters');\n\t\tapp.showPopoverElementView(clearBtn);\n\t\tclearBtn.on('click', () => {\n\t\t\t$('.js-calendar__extended-filter-tab a').removeClass('active');\n\t\t\tapp.setMainParams('showType', 'current');\n\t\t\tapp.moduleCacheSet('defaultShowType', 'current');\n\t\t\tsidebar.find('input:checkbox').prop('checked', false);\n\t\t\tsidebar.find('option:selected').prop('selected', false).trigger('change.select2');\n\t\t\tsidebar.find('.js-sidebar-filter-container').each((_, e) => {\n\t\t\t\tlet element = $(e);\n\t\t\t\tlet cacheName = element.data('cache');\n\t\t\t\tif (element.data('name') && cacheName) {\n\t\t\t\t\tapp.moduleCacheSet(cacheName, '');\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet calendarSwitch = sidebar.find('.js-switch--showType [class*=\"js-switch--label\"]'),\n\t\t\t\tactualUserCheckbox = sidebar.find('.js-input-user-owner-id[value=' + app.getMainParams('userId') + ']');\n\t\t\tcalendarSwitch.last().removeClass('active');\n\t\t\tcalendarSwitch.first().addClass('active');\n\t\t\t$('input[data-val=\"current\"]', calendarSwitch).prop('checked', true);\n\t\t\tif (actualUserCheckbox.length) {\n\t\t\t\tactualUserCheckbox.prop('checked', true);\n\t\t\t} else {\n\t\t\t\tapp.setMainParams('usersId', undefined);\n\t\t\t}\n\t\t\tthis.reloadCalendarData();\n\t\t});\n\t}\n\t/**\n\t * Register filter tab change\n\t */\n\tregisterFilterTabChange() {\n\t\tthis.calendarView.find('.js-calendar__extended-filter-tab').on('shown.bs.tab', () => {\n\t\t\tthis.reloadCalendarData();\n\t\t});\n\t}\n\t/**\n\t * Function appends and shows today button's checkbox\n\t * @param {jQuery} toolbar\n\t */\n\tshowTodayButtonCheckbox(toolbar) {\n\t\tlet todayButton = toolbar.find('.fc-today-button'),\n\t\t\ttodyButtonIcon = todayButton.attr('disabled') ? 'fa-calendar-check' : 'fa-calendar',\n\t\t\tpopoverContent = todayButton.attr('title');\n\t\ttodayButton.html(`<div class=\"js-popover-tooltip\"><span class=\"far fa-lg ${todyButtonIcon}\"></span></div>`);\n\t\tapp.showPopoverElementView(todayButton.find('.js-popover-tooltip'), {\n\t\t\ttitle: popoverContent\n\t\t});\n\t}\n\t/**\n\t * Registration of the event being added to favorite users\n\t */\n\tregisterPinUser() {\n\t\tconst self = this;\n\t\tthis.getSidebarView()\n\t\t\t.find('.js-pin-user')\n\t\t\t.on('click', function () {\n\t\t\t\tconst element = $(this);\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: self.module,\n\t\t\t\t\taction: 'Calendar',\n\t\t\t\t\tmode: 'pinOrUnpinUser',\n\t\t\t\t\telement_id: element.data('elementid')\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tif (data.result === 'unpin') {\n\t\t\t\t\t\telement.find('.js-pin-icon').removeClass('fas').addClass('far');\n\t\t\t\t\t} else if (data.result === 'pin') {\n\t\t\t\t\t\telement.find('.js-pin-icon').removeClass('far').addClass('fas');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t}\n\t/**\n\t * Register cache settings\n\t */\n\tregisterCacheSettings() {}\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerCacheSettings();\n\t\tthis.registerSwitchEvents();\n\t\tthis.registerPinUser();\n\t\tElementQueries.listen();\n\t}\n};\n"],"names":["window","Vtiger_Calendar_Js","container","readonly","browserHistory","self","allDaySlot","dateClick","args","eventCreate","registerDayClickEvent","selectable","eventClick","info","jsEvent","preventDefault","element","$","el","link","attr","find","inArray","event","classNames","app","showModalWindow","replace","Object","assign","headerToolbar","left","getMainParams","center","right","select","selectDays","datesSet","dateInfo","trigger","fullCalendar","view","loadCalendarData","length","tab","defaultParams","getDefaultParams","progressInstance","progressIndicator","blockInfo","enabled","removeAllEvents","clearFilterButton","getCurrentCvId","AppConnector","request","done","events","addEventSource","result","mode","updateCountTaskCalendar","user","cvId","currentUser","parseInt","time","statement","JSON","stringify","toggleClass","options","getSelectedUsersCalendar","activeEnd","add","getSidebarView","data","history","sidebar","selectedUsers","notSelectedUsers","selectedUsersAjax","selectedRolesAjax","checkboxSelectAll","selectedIds","excludedIds","ifSelectAllIsChecked","is","push","each","val","concat","CONFIG","userId","userFormat","App","Fields","Date","dateToUserFormat","date","isQuickCreateSupported","getCalendarCreateView","Components","QuickCreate","showModal","callbackFunction","reloadCalendarData","callbackPostShown","modal","dayCallbackCreateModal","openUrl","module","endTimeString","dateFormat","timeFormat","defaultTimeFormat","startTimeString","moment","format","type","now","isWorkDays","switchShowTypeVal","switchContainer","switchShowType","showTypeState","switchSwitchingDays","switchingDaysState","historyParams","moduleCacheGet","button","setMainParams","hiddenDays","on","e","currentTarget","moduleCacheSet","filter","setOption","setCalendarHeight","console","log","toolbar","calendarView","showChangeDateButtons","appendSubDateRow","refreshDatesRowView","addHeaderButtons","showTodayButtonCheckbox","buttonText","calendarOptions","nextPrevButtons","yearButtons","first","html","last","Calendar_Js","viewsNamesLabels","viewType","hide","show","subDateRow","append","width","breakpoints","lg","showNewScrollbar","generateYearList","generateMonthList","generateWeekList","generateDaysList","registerDatesChange","datesView","activeDays","currentStart","nextDays","prevDays","subtract","daysToShow","diff","day","dateUser","active","fullDaysTranslated","vtranslate","activeWeek","nextWeeks","prevWeeks","dateEnd","dateEndUser","activeMonth","getMonth","activeYear","getFullYear","month","m","lastDay","getLastMonthDay","monthsTranslated","prevYear","subDatesElements","dateArray","start","end","key","split","dates","removeClass","addClass","gotoDate","buttonsContainer","prev","viewBtn","clone","filters","eq","prepend","after","registerClearFilterButton","registerFilterTabChange","clearBtn","showPopoverElementView","prop","_","cacheName","calendarSwitch","actualUserCheckbox","todayButton","todyButtonIcon","popoverContent","title","action","element_id","showNotify","text","registerCacheSettings","registerSwitchEvents","registerPinUser","ElementQueries","listen"],"mappings":"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"}