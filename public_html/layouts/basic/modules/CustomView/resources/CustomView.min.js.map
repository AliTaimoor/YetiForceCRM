{"version":3,"file":"CustomView.min.js","sources":["CustomView.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n * Contributor(s): YetiForce.com\n *************************************************************************************/\n'use strict';\n\nclass CustomView {\n\tconstructor(url) {\n\t\tlet progressIndicatorElement = $.progressIndicator({\n\t\t\tposition: 'html',\n\t\t\tblockInfo: {\n\t\t\t\tenabled: true\n\t\t\t}\n\t\t});\n\t\tapp.showModalWindow(null, url, () => {\n\t\t\tthis.modalContainer = $('.js-filter-modal__container');\n\t\t\tthis.advanceFilterInstance = new Vtiger_ConditionBuilder_Js(\n\t\t\t\tthis.modalContainer.find('.js-condition-builder-view .js-condition-builder'),\n\t\t\t\tthis.modalContainer.find('#sourceModule').val()\n\t\t\t);\n\t\t\tthis.advanceFilterInstance.registerEvents();\n\t\t\tCustomView.registerAdvancedConditionsEvents(this.modalContainer);\n\n\t\t\t//This will store the columns selection container\n\t\t\tthis.columnSelectElement = false;\n\t\t\tthis.registerEvents();\n\t\t\tprogressIndicatorElement.progressIndicator({ mode: 'hide' });\n\t\t});\n\t}\n\n\t/** @type {Vtiger_ConditionBuilder_Js} Condition builder object */\n\tstatic advancedConditionsBuilder;\n\n\tloadDateFilterValues() {\n\t\tlet selectedDateFilter = $('#standardDateFilter option:selected');\n\t\tlet currentDate = selectedDateFilter.data('currentdate');\n\t\tlet endDate = selectedDateFilter.data('enddate');\n\t\t$('#standardFilterCurrentDate').val(currentDate);\n\t\t$('#standardFilterEndDate').val(endDate);\n\t}\n\n\t/**\n\t * Function to get the contents container\n\t * @return : jQuery object of contents container\n\t */\n\tgetContentsContainer() {\n\t\tif (this.modalContainer == false) {\n\t\t\tthis.modalContainer = $('.js-filter-modal__container');\n\t\t}\n\t\treturn this.modalContainer;\n\t}\n\n\t/**\n\t * Function to get the view columns selection element\n\t * @return : jQuery object of view columns selection element\n\t */\n\tgetColumnSelectElement() {\n\t\tif (this.columnSelectElement == false) {\n\t\t\tthis.columnSelectElement = $('#viewColumnsSelect');\n\t\t}\n\t\treturn this.columnSelectElement;\n\t}\n\n\t/**\n\t * Function which will get the selected columns\n\t * @return : array of selected values\n\t */\n\tgetSelectedColumns() {\n\t\tlet columnListSelectElement = this.getColumnSelectElement();\n\t\treturn columnListSelectElement.val();\n\t}\n\n\tsaveFilter() {\n\t\tlet aDeferred = $.Deferred();\n\t\tlet formData = $('#CustomView').serializeFormData();\n\t\tAppConnector.request(formData, true)\n\t\t\t.done(function (data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t})\n\t\t\t.fail(function (error) {\n\t\t\t\taDeferred.reject(error);\n\t\t\t});\n\t\treturn aDeferred.promise();\n\t}\n\n\tsaveAndViewFilter() {\n\t\tthis.saveFilter().done(function (data) {\n\t\t\tlet response = data.result;\n\t\t\tif (response && response.success) {\n\t\t\t\tlet url;\n\t\t\t\tif (app.getParentModuleName() == 'Settings') {\n\t\t\t\t\turl = 'index.php?module=CustomView&parent=Settings&view=Index&sourceModule=' + $('#sourceModule').val();\n\t\t\t\t} else {\n\t\t\t\t\turl = response.listviewurl;\n\t\t\t\t}\n\t\t\t\twindow.location.href = url;\n\t\t\t} else {\n\t\t\t\t$.unblockUI();\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttitle: app.vtranslate('JS_DUPLICATE_RECORD'),\n\t\t\t\t\ttext: response.message,\n\t\t\t\t\ttype: 'error'\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tregisterIconEvents() {\n\t\tthis.getContentsContainer()\n\t\t\t.find('.js-filter-preferences')\n\t\t\t.on('change', '.js-filter-preference', (e) => {\n\t\t\t\tlet currentTarget = $(e.currentTarget);\n\t\t\t\tlet iconElement = currentTarget.next();\n\t\t\t\tif (currentTarget.prop('checked')) {\n\t\t\t\t\ticonElement.removeClass(iconElement.data('unchecked')).addClass(iconElement.data('check'));\n\t\t\t\t} else {\n\t\t\t\t\ticonElement.removeClass(iconElement.data('check')).addClass(iconElement.data('unchecked'));\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tregisterColorEvent() {\n\t\tconst container = this.getContentsContainer();\n\t\tlet picker = container.find('.js-color-picker');\n\t\tlet pickerField = picker.find('.js-color-picker__field');\n\t\tlet showPicker = () => {\n\t\t\tApp.Fields.Colors.showPicker({\n\t\t\t\tcolor: pickerField.val(),\n\t\t\t\tbgToUpdate: picker.find('.js-color-picker__color'),\n\t\t\t\tfieldToUpdate: pickerField\n\t\t\t});\n\t\t};\n\t\tpicker.on('click', showPicker);\n\t}\n\n\t/**\n\t * Get list of fields to duplicates\n\t * @returns {Array}\n\t */\n\tgetDuplicateFields() {\n\t\tlet fields = [];\n\t\tconst container = this.getContentsContainer();\n\t\tcontainer.find('.js-duplicates-container .js-duplicates-row').each(function () {\n\t\t\tfields.push({\n\t\t\t\tfieldid: $(this).find('.js-duplicates-field').val(),\n\t\t\t\tignore: $(this).find('.js-duplicates-ignore').is(':checked')\n\t\t\t});\n\t\t});\n\t\treturn fields;\n\t}\n\t/**\n\t * Register events for block \"Find duplicates\"\n\t */\n\tregisterDuplicatesEvents() {\n\t\tconst container = this.getContentsContainer();\n\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('.js-duplicates-container .js-duplicates-field'));\n\t\tcontainer.on('click', '.js-duplicates-remove', function (e) {\n\t\t\t$(this).closest('.js-duplicates-row').remove();\n\t\t});\n\t\tcontainer.find('.js-duplicate-add-field').on('click', function () {\n\t\t\tlet template = container.find('.js-duplicates-field-template').clone();\n\t\t\ttemplate.removeClass('d-none');\n\t\t\ttemplate.removeClass('js-duplicates-field-template');\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(template.find('.js-duplicates-field'));\n\t\t\tcontainer.find('.js-duplicates-container').append(template);\n\t\t});\n\t}\n\tregisterSubmitEvent(select2Element) {\n\t\t$('#CustomView').on('submit', (e) => {\n\t\t\tconst form = $(e.currentTarget);\n\t\t\tlet selectElement = this.getColumnSelectElement();\n\t\t\tif ($('#viewname').val().length > 100) {\n\t\t\t\tapp.showNotify({\n\t\t\t\t\ttitle: app.vtranslate('JS_MESSAGE'),\n\t\t\t\t\ttext: app.vtranslate('JS_VIEWNAME_ALERT'),\n\t\t\t\t\ttype: 'error'\n\t\t\t\t});\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//Mandatory Fields selection validation\n\t\t\t//Any one Mandatory Field should select while creating custom view.\n\t\t\tlet mandatoryFieldsList = JSON.parse($('#mandatoryFieldsList').val());\n\t\t\tlet selectedOptions = selectElement.val();\n\t\t\tlet mandatoryFieldsMissing = true;\n\t\t\tif (selectedOptions) {\n\t\t\t\tfor (let i = 0; i < selectedOptions.length; i++) {\n\t\t\t\t\tif ($.inArray(selectedOptions[i], mandatoryFieldsList) >= 0) {\n\t\t\t\t\t\tmandatoryFieldsMissing = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (mandatoryFieldsMissing) {\n\t\t\t\tselectElement.validationEngine(\n\t\t\t\t\t'showPrompt',\n\t\t\t\t\tapp.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_MANDATORY_FIELD'),\n\t\t\t\t\t'error',\n\t\t\t\t\t'topLeft',\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tselect2Element.validationEngine('hide');\n\t\t\t}\n\t\t\t//Mandatory Fields validation ends\n\t\t\tlet result = form.validationEngine('validate');\n\t\t\tif (result == true) {\n\t\t\t\t//handled standard filters saved values.\n\t\t\t\tlet stdfilterlist = {};\n\n\t\t\t\tif (\n\t\t\t\t\t$('#standardFilterCurrentDate').val() != '' &&\n\t\t\t\t\t$('#standardFilterEndDate').val() != '' &&\n\t\t\t\t\t$('select.standardFilterColumn option:selected').val() != 'none'\n\t\t\t\t) {\n\t\t\t\t\tstdfilterlist['columnname'] = $('select.standardFilterColumn option:selected').val();\n\t\t\t\t\tstdfilterlist['stdfilter'] = $('select#standardDateFilter option:selected').val();\n\t\t\t\t\tstdfilterlist['startdate'] = $('#standardFilterCurrentDate').val();\n\t\t\t\t\tstdfilterlist['enddate'] = $('#standardFilterEndDate').val();\n\t\t\t\t\t$('#stdfilterlist').val(JSON.stringify(stdfilterlist));\n\t\t\t\t}\n\t\t\t\t//handled advanced filters saved values.\n\t\t\t\t$('#advfilterlist').val(JSON.stringify(this.advanceFilterInstance.getConditions()));\n\t\t\t\tform.find('#advancedConditions').val(JSON.stringify(CustomView.getAdvancedConditions(form)));\n\t\t\t\t$('[name=\"duplicatefields\"]').val(JSON.stringify(this.getDuplicateFields()));\n\t\t\t\t$('input[name=\"columnslist\"]', this.getContentsContainer()).val(JSON.stringify(this.getSelectedColumns()));\n\t\t\t\tthis.saveAndViewFilter();\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tapp.formAlignmentAfterValidation($(e.currentTarget));\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Block submit on press enter key\n\t */\n\tregisterDisableSubmitOnEnter() {\n\t\tthis.getContentsContainer()\n\t\t\t.find('#viewname, [name=\"color\"]')\n\t\t\t.on('keydown', (e) => {\n\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t/**\n\t * Function to register the advanced conditions events for customview\n\t * @param {jQuery} listViewContainer\n\t */\n\tstatic registerCustomViewAdvCondEvents(listViewContainer) {\n\t\tlistViewContainer.on('click', '.js-custom-view-adv-cond-modal', () => {\n\t\t\tconst customViewAdvCond = listViewContainer.find('.js-custom-view-adv-cond');\n\t\t\tlet advancedConditions = customViewAdvCond.val();\n\t\t\tif (advancedConditions) {\n\t\t\t\tadvancedConditions = JSON.parse(advancedConditions);\n\t\t\t}\n\t\t\tAppConnector.request({\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tview: 'CustomViewAdvCondModal',\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tadvancedConditions: advancedConditions\n\t\t\t})\n\t\t\t\t.done((data) => {\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tapp.showModalWindow(data, (modalContainer) => {\n\t\t\t\t\t\t\tApp.Tools.Form.registerBlockToggle(modalContainer);\n\t\t\t\t\t\t\tthis.registerAdvancedConditionsEvents(modalContainer);\n\t\t\t\t\t\t\tmodalContainer.find('[name=\"saveButton\"]').on('click', (e) => {\n\t\t\t\t\t\t\t\tcustomViewAdvCond.val(JSON.stringify(this.getAdvancedConditions(modalContainer)));\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t\tif (typeof app.pageController.getListViewRecords !== 'undefined') {\n\t\t\t\t\t\t\t\t\tapp.pageController.getListViewRecords();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttitle: app.vtranslate('JS_ERROR'),\n\t\t\t\t\t\ttext: errorThrown,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t});\n\t}\n\t/**\n\t * Function to register the advanced conditions events for custom view\n\t * @param {jQuery} container\n\t */\n\tstatic registerAdvancedConditionsEvents(container) {\n\t\tconst self = this;\n\t\tconst builder = container.find('.js-adv-condition-builder-view');\n\t\tconst relationSelect = container.find('.js-relation-select');\n\t\tif (relationSelect.val() != 0) {\n\t\t\tthis.advancedConditionsBuilder = new Vtiger_ConditionBuilder_Js(\n\t\t\t\tbuilder.find('.js-condition-builder'),\n\t\t\t\trelationSelect.find('option:selected').data('module')\n\t\t\t);\n\t\t\tthis.advancedConditionsBuilder.registerEvents();\n\t\t}\n\t\trelationSelect.on('change', function (e) {\n\t\t\tconst moduleName = $(this).find('option:selected').data('module');\n\t\t\tbuilder.html('');\n\t\t\tdelete self.advancedConditionsBuilder;\n\t\t\tif (moduleName) {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\tview: 'ConditionBuilder',\n\t\t\t\t\tmode: 'builder',\n\t\t\t\t\tsourceModuleName: moduleName\n\t\t\t\t}).done((data) => {\n\t\t\t\t\tbuilder.html(data);\n\t\t\t\t\tself.advancedConditionsBuilder = new Vtiger_ConditionBuilder_Js(\n\t\t\t\t\t\tbuilder.find('.js-condition-builder'),\n\t\t\t\t\t\tmoduleName\n\t\t\t\t\t);\n\t\t\t\t\tself.advancedConditionsBuilder.registerEvents();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\t/**\n\t * Function to register the advanced conditions events for custom view\n\t * @param {jQuery} container\n\t * @return {object}\n\t */\n\tstatic getAdvancedConditions(container) {\n\t\tconst advancedConditions = {\n\t\t\trelationId: container.find('.js-relation-select').val()\n\t\t};\n\t\tcontainer.find('.js-relation-checkbox:checked').each(function () {\n\t\t\tif (typeof advancedConditions.relationColumns === 'undefined') {\n\t\t\t\tadvancedConditions.relationColumns = [];\n\t\t\t}\n\t\t\tadvancedConditions.relationColumns.push($(this).val());\n\t\t});\n\t\tif (this.advancedConditionsBuilder) {\n\t\t\tadvancedConditions.relationConditions = this.advancedConditionsBuilder.getConditions();\n\t\t}\n\t\treturn advancedConditions;\n\t}\n\t/**\n\t * Register events\n\t */\n\tregisterEvents() {\n\t\tthis.registerIconEvents();\n\t\tApp.Fields.Tree.register(this.getContentsContainer());\n\t\tApp.Tools.Form.registerBlockToggle(this.getContentsContainer());\n\t\tthis.registerColorEvent();\n\t\tthis.registerDuplicatesEvents();\n\t\tconst select2Element = App.Fields.Picklist.showSelect2ElementView(this.getColumnSelectElement());\n\t\tthis.registerSubmitEvent(select2Element);\n\t\t$('.stndrdFilterDateSelect').datepicker();\n\t\t$('#standardDateFilter').on('change', () => {\n\t\t\tthis.loadDateFilterValues();\n\t\t});\n\t\t$('#CustomView').validationEngine(app.validationEngineOptions);\n\t\tthis.registerDisableSubmitOnEnter();\n\t}\n}\n"],"names":["CustomView","url","progressIndicatorElement","$","progressIndicator","position","blockInfo","enabled","app","showModalWindow","modalContainer","advanceFilterInstance","Vtiger_ConditionBuilder_Js","find","val","registerEvents","registerAdvancedConditionsEvents","columnSelectElement","mode","selectedDateFilter","currentDate","data","endDate","columnListSelectElement","getColumnSelectElement","aDeferred","Deferred","formData","serializeFormData","AppConnector","request","done","resolve","fail","error","reject","promise","saveFilter","response","result","success","getParentModuleName","listviewurl","window","location","href","unblockUI","showNotify","title","vtranslate","text","message","type","getContentsContainer","on","e","currentTarget","iconElement","next","prop","removeClass","addClass","container","picker","pickerField","showPicker","App","Fields","Colors","color","bgToUpdate","fieldToUpdate","fields","each","push","fieldid","ignore","is","Picklist","showSelect2ElementView","closest","remove","template","clone","append","select2Element","form","selectElement","length","preventDefault","mandatoryFieldsList","JSON","parse","selectedOptions","mandatoryFieldsMissing","i","inArray","validationEngine","stdfilterlist","stringify","getConditions","getAdvancedConditions","getDuplicateFields","getSelectedColumns","saveAndViewFilter","formAlignmentAfterValidation","key","registerIconEvents","Tree","register","Tools","Form","registerBlockToggle","registerColorEvent","registerDuplicatesEvents","registerSubmitEvent","datepicker","loadDateFilterValues","validationEngineOptions","registerDisableSubmitOnEnter","listViewContainer","customViewAdvCond","advancedConditions","module","getModuleName","view","hideModalWindow","pageController","getListViewRecords","textStatus","errorThrown","self","builder","relationSelect","advancedConditionsBuilder","moduleName","html","parent","sourceModuleName","relationId","relationColumns","relationConditions"],"mappings":"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"}